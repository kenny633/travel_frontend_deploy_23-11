(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[309],{2431:()=>{},2437:(t,e,o)=>{Promise.resolve().then(o.bind(o,3817))},3817:(t,e,o)=>{"use strict";o.r(e),o.d(e,{default:()=>s});var n=o(7437);o(7641);var r=o(2265),a=o(6463),c=o(3390);function s(){let{keyword:t}=(0,a.useParams)();t=decodeURIComponent(t);let[e,o]=(0,r.useState)([]);return(0,r.useEffect)(()=>{let e=async()=>{try{console.log("搜索关键字:",t);let e=await (0,c.v_)("/posts/search",{keyword:t});200===e.status&&(o(e.posts),console.log("搜索结果:",e))}catch(t){console.error("搜索请求失败:",t)}};t&&e()},[t]),(0,n.jsx)("div",{children:e.map(t=>{var e;return(0,n.jsxs)("div",{children:[(0,n.jsx)("h2",{children:t.title}),t.img_path&&(0,n.jsx)("img",{src:t.img_path,alt:t.title}),(0,n.jsx)("div",{dangerouslySetInnerHTML:{__html:(e=t.content).replace(/<[^>]+>/g,"").length<=100?e:e.substring(0,100)+"..."}}),(0,n.jsx)("p",{children:"--------------------"})]},t._id)})})}},3426:(t,e,o)=>{"use strict";function n(){return localStorage.getItem("token")}function r(){localStorage.removeItem("token")}function a(){return localStorage.getItem("userId")}o.d(e,{LP:()=>n,gy:()=>r,n5:()=>a})},3390:(t,e,o)=>{"use strict";o.d(e,{Ix:()=>l,U2:()=>c,v_:()=>s});var n=o(3426);let r="http://localhost:3001";async function a(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=!(arguments.length>2)||void 0===arguments[2]||arguments[2];if(e.headers={"Content-Type":"application/json",...e.headers},o){let t=(0,n.LP)();t&&(e.headers.Authorization="Bearer ".concat(t))}try{let o=await fetch("".concat(r).concat(t),e);if(!o.ok)throw Error("请求错误！");return o.json()}catch(e){console.log("请求哪条api出错:","".concat(r).concat(t)),console.log("请求失败:",e)}}function c(t,e){return a(t,{method:"GET",needToken:e})}function s(t,e,o){return a(t,{method:"POST",body:JSON.stringify(e),needToken:o})}async function l(t){let e=new FormData;e.append("image",t);try{let t=await fetch("".concat(r,"/upload"),{method:"POST",body:e});if(!t.ok)throw Error("图片上传失败！");return await t.json()}catch(t){throw console.error("上传图片失败:",t),t}}}},t=>{var e=e=>t(t.s=e);t.O(0,[881,634,130,215,744],()=>e(2437)),_N_E=t.O()}]);