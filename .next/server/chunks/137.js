exports.id=137,exports.ids=[137],exports.modules={7148:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,6472,23)),Promise.resolve().then(r.t.bind(r,2461,23)),Promise.resolve().then(r.t.bind(r,8190,23)),Promise.resolve().then(r.t.bind(r,5282,23)),Promise.resolve().then(r.t.bind(r,6613,23)),Promise.resolve().then(r.t.bind(r,5486,23)),Promise.resolve().then(r.t.bind(r,8825,23))},4849:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,2144,23)),Promise.resolve().then(r.t.bind(r,2302,23)),Promise.resolve().then(r.t.bind(r,3582,23)),Promise.resolve().then(r.t.bind(r,9587,23)),Promise.resolve().then(r.t.bind(r,5329,23)),Promise.resolve().then(r.t.bind(r,599,23)),Promise.resolve().then(r.t.bind(r,2118,23))},1409:(e,t,r)=>{Promise.resolve().then(r.bind(r,934))},1871:(e,t,r)=>{Promise.resolve().then(r.bind(r,3022))},3022:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>j});var s=r(6493),o=r(5444),n=r.n(o),l=r(7081),a=r.n(l),i=r(3606),d=r(7573);let c={modalOverlay:{position:"fixed",top:"0",left:"0",right:"0",bottom:"0",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:1e3},modalContent:{background:"white",padding:"40px",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.2)",width:"350px",textAlign:"center"},input:{width:"100%",padding:"12px",margin:"10px 0",border:"1px solid #ccc",borderRadius:"5px",transition:"border-color 0.3s, box-shadow 0.3s",boxSizing:"border-box",outline:"none"},button:{padding:"12px 20px",width:"100%",background:"#6e8efb",color:"white",border:"none",borderRadius:"5px",cursor:"pointer",transition:"background 0.3s, transform 0.3s",margin:"10px 0",fontWeight:"bold"}},u=({onClose:e,onLoginSuccess:t})=>{let[r,o]=(0,i.useState)(""),[n,l]=(0,i.useState)("");async function a(e){if(e.preventDefault(),r&&n){let e=await (0,d.v_)("/users/check-login",{usernameOrEmail:r,password:n},!1);console.log("Response from server:",e),200===e.status?(console.log(e),localStorage.setItem("token",e.token),localStorage.setItem("userId",e.data._id),window.location.reload(),t(e.data)):(e.status,alert(e.message))}else alert("用户名或密码不能为空。")}return(0,s.jsx)("div",{className:"modalOverlay",style:c.modalOverlay,onClick:e,children:(0,s.jsxs)("div",{className:"modalContent",style:c.modalContent,onClick:e=>e.stopPropagation(),children:[(0,s.jsx)("h2",{children:"登入"}),(0,s.jsxs)("form",{onSubmit:a,children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"usernameOrEmail",children:"帳戶/電子郵件"}),(0,s.jsx)("input",{type:"text",id:"usernameOrEmail",value:r,onChange:e=>o(e.target.value),required:!0,style:c.input})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"password",children:"密碼"}),(0,s.jsx)("input",{type:"password",id:"password",value:n,onChange:e=>l(e.target.value),required:!0,style:c.input})]}),(0,s.jsx)("button",{type:"submit",style:c.button,children:"登入"})]})]})})},A={modalOverlay:{position:"fixed",top:"0",left:"0",right:"0",bottom:"0",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:1e3},modalContent:{background:"white",padding:"40px",borderRadius:"10px",boxShadow:"0 10px 30px rgba(0, 0, 0, 0.1)",width:"400px",color:"black",textAlign:"center"},input:{width:"100%",padding:"12px",margin:"10px 0",border:"1px solid #ddd",borderRadius:"5px",transition:"border-color 0.3s, box-shadow 0.3s",boxSizing:"border-box",outline:"none",color:"#333"},button:{padding:"12px 20px",width:"100%",background:"#6e8efb",color:"white",border:"none",borderRadius:"5px",cursor:"pointer",transition:"background 0.3s, transform 0.3s",margin:"10px 0",fontWeight:"bold"}},h=({onClose:e,onLoginSuccess:t})=>{let[r,o]=(0,i.useState)(""),[n,l]=(0,i.useState)(""),[a,c]=(0,i.useState)(""),[u,h]=(0,i.useState)(""),[m,p]=(0,i.useState)(""),[g,x]=(0,i.useState)(""),b=async s=>{if(s.preventDefault(),u!==m){x("密码和确认密码不匹配");return}try{let s=await (0,d.v_)("/users/Create-user",{name:r,username:n,email:a,password:u},!1);200===s.status?(console.log("注册成功"),localStorage.setItem("token",s.token),localStorage.setItem("userId",s.data._id),t({username:s.data.username,email:s.data.email}),e()):(console.log("注册失败:",s.message),x(s.message))}catch(e){console.error(e),x("发生错误，请稍后再试。")}};return(0,s.jsx)("div",{className:"modalOverlay",style:A.modalOverlay,onClick:e,children:(0,s.jsxs)("div",{className:"modalContent",style:A.modalContent,onClick:e=>e.stopPropagation(),children:[(0,s.jsx)("h2",{children:"注册"}),g&&(0,s.jsx)("p",{style:{color:"red"},children:g})," ",(0,s.jsxs)("form",{onSubmit:b,children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"accountName",children:"账户名称"}),(0,s.jsx)("input",{type:"text",id:"accountName",value:n,onChange:e=>l(e.target.value),required:!0,style:A.input})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"username",children:"用户名"}),(0,s.jsx)("input",{type:"text",id:"username",value:r,onChange:e=>o(e.target.value),required:!0,style:A.input})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"email",children:"电子邮件"}),(0,s.jsx)("input",{type:"email",id:"email",value:a,onChange:e=>c(e.target.value),required:!0,style:A.input})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"password",children:"密码"}),(0,s.jsx)("input",{type:"password",id:"password",value:u,onChange:e=>h(e.target.value),required:!0,style:A.input})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"confirmPassword",children:"确认密码"}),(0,s.jsx)("input",{type:"password",id:"confirmPassword",value:m,onChange:e=>p(e.target.value),required:!0,style:A.input})]}),(0,s.jsx)("button",{type:"submit",style:A.button,children:"注册"})]})]})})};var m=r(7689);let p={src:"/_next/static/media/logo.de7d5e9a.png",height:459,width:544,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAHCAMAAAACh/xsAAAAFVBMVEVCZlM+ZVRCZlRBZlRDZlRBZVJCZ1Q+iudNAAAAB3RSTlM7C01VeiVkMj0QewAAAAlwSFlzAAALEwAACxMBAJqcGAAAACxJREFUeJwdyrcNADAQw0DF339kQ2Z1BUGsErzBBKVEGpzDxyUfbtE9sGTwAQxhAG/rT8HQAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:7};var g=r(4971);let x={src:"/_next/static/media/createpost.fd9fe6a9.png",height:120,width:120,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAJFBMVEURl9wAk9oRl90Rmt8RltoSltoRltsNl9USldsRldsSltsUq/nHqbs7AAAAC3RSTlObAaFHv4dqJcHHk7hdskMAAAAJcEhZcwAACxMAAAsTAQCanBgAAAAySURBVHicJcrJDQAgDAPB3YRT9N8vCvjjsWQWRHdsUI0YD3GwUN3BPDXAmSr/XGi8tAsWAgCD8v2P+AAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8},b={src:"/_next/static/media/search.5b127859.png",height:120,width:120,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAG1BMVEUbGxsrKystLS0tLS0sLCwtLS0qKiosLCwsLCwzWUgmAAAACXRSTlMBtg4nnzY6RdCaJwB/AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAMUlEQVR4nCWLyQ0AMAzCDLm6/8RVWl4YGcBhNq3UbFETMkQCWWDFXxilTq3kdun9FrgQMABw6U36lgAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8};var f=r(5723),v=r(4619);r(2307);let w={src:"/_next/static/media/user.c64fa86c.png",height:120,width:120,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAWlBMVEUSnesPpvQYgbgVm+AeFBAcWnsUfLQFlN9MaXE1IxgcXoLp4thZrtn78Op+vuC91+K91+MToOr/4LxtobUUJC0zpN3p3MUGm+n96cqckID858iXi32b1PKe1fJX2UErAAAAEnRSTlMurrSv/vvs8AD5+/75/q7z86znyt2OAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAQklEQVR4nAXBBxKAIBAAsRWRo+tQrf//pgkW5TeFBdO0bgYW767HbQtSy3mXKkgfpYwurDOGEOcK8qX0CljyfmTsD122Ate7Iq/yAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8};function j({children:e}){let[t,r]=(0,i.useState)(!1),[o,l]=(0,i.useState)(!1),[d,c]=(0,i.useState)(!1),[A,j]=(0,i.useState)({}),[y,C]=(0,i.useState)(!1),S=(0,v.usePathname)(),[k,R]=(0,i.useState)(""),U=e=>{j(e),c(!0),r(!1)};return(0,s.jsx)("html",{lang:"en",children:(0,s.jsxs)("body",{className:`${n().variable} ${a().variable} antialiased`,children:[(0,s.jsx)("header",{className:"flex items-center justify-center w-full py-2 border-b border-gray-300",children:(0,s.jsxs)("div",{className:"flex items-center justify-between w-4/5 mx-auto",children:[(0,s.jsx)("div",{className:"flex items-center",children:(0,s.jsx)(f.default,{href:"/",children:(0,s.jsx)(g.default,{src:p,alt:"Logo",width:50,height:50,className:"rounded-full"})})}),(0,s.jsxs)("div",{className:"flex items-center flex-1 mx-5",children:[(0,s.jsx)("input",{type:"text",placeholder:"搜索...",className:"flex-1 px-3 py-2 border border-gray-300 rounded",value:k,onChange:e=>R(e.target.value)}),(0,s.jsx)("button",{onClick:()=>{k.trim()&&(window.location.href=`/post/search/${k}`)},children:(0,s.jsx)(g.default,{src:b,alt:"搜索",width:30,height:30,className:"ml-3 cursor-pointer"})})]}),(0,s.jsx)("div",{className:"flex",children:d?(0,s.jsxs)("div",{className:"relative inline-block group flex items-center",children:[(0,s.jsx)(f.default,{href:"/userprofile",className:"flex items-center",children:(0,s.jsx)(g.default,{src:A.img_path||w,alt:`${A.username||"用户"}的头像`,width:50,height:50,className:"cursor-pointer rounded-full object-cover"})}),(0,s.jsxs)("div",{className:"absolute hidden w-60 p-4 bg-white border border-gray-300 shadow-md mt-40 group-hover:block",style:{zIndex:1e4},children:[(0,s.jsxs)("p",{children:["用户名: ",A.name]}),(0,s.jsxs)("p",{children:["邮箱: ",A.email]}),(0,s.jsxs)("p",{children:["身份: ",A.role]})]}),(0,s.jsx)("button",{className:"px-4 py-2 ml-2 text-white bg-blue-600 rounded",onClick:()=>{c(!1),j({}),(0,m.gy)(),localStorage.removeItem("userId")},children:"登出"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{className:"px-4 py-2 ml-2 text-white bg-blue-600 rounded",onClick:()=>r(!0),children:"登入"}),(0,s.jsx)("button",{className:"px-4 py-2 ml-2 text-white bg-blue-600 rounded",onClick:()=>l(!0),children:"注册"})]})})]})}),t&&(0,s.jsx)(u,{isOpen:t,onClose:()=>r(!1),onLoginSuccess:U}),o&&(0,s.jsx)(h,{onClose:()=>l(!1),onLoginSuccess:U}),d&&"/createpost"!==S&&(0,s.jsx)("div",{className:"fixed bottom-16 right-5 p-2 cursor-pointer",children:(0,s.jsx)(f.default,{href:"/createpost",children:(0,s.jsx)(g.default,{src:x,alt:"发帖",width:40,height:40})})}),e,y&&(0,s.jsx)("button",{onClick:()=>{window.scrollTo({top:0,behavior:"smooth"})},className:"fixed bottom-5 right-5 flex items-center justify-center w-12 h-12 bg-blue-600 text-white rounded-full transition-colors duration-300 hover:bg-blue-700",children:"↑"})]})})}r(5735)},7689:(e,t,r)=>{"use strict";function s(){return localStorage.getItem("token")}function o(){localStorage.removeItem("token")}function n(){return localStorage.getItem("userId")}r.d(t,{LP:()=>s,gy:()=>o,n5:()=>n})},7573:(e,t,r)=>{"use strict";r.d(t,{Ix:()=>i,U2:()=>l,v_:()=>a});var s=r(7689);let o="http://localhost:3001";async function n(e,t={},r=!0){if(t.headers={"Content-Type":"application/json",...t.headers},r){let e=(0,s.LP)();e&&(t.headers.Authorization=`Bearer ${e}`)}try{let r=await fetch(`${o}${e}`,t);if(!r.ok)throw Error("请求错误！");return r.json()}catch(t){console.log("请求哪条api出错:",`${o}${e}`),console.log("请求失败:",t)}}function l(e,t){return n(e,{method:"GET",needToken:t})}function a(e,t,r){return n(e,{method:"POST",body:JSON.stringify(t),needToken:r})}async function i(e){let t=new FormData;t.append("image",e);try{let e=await fetch(`${o}/upload`,{method:"POST",body:t});if(!e.ok)throw Error("图片上传失败！");return await e.json()}catch(e){throw console.error("上传图片失败:",e),e}}},934:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(8105).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/jiumi/Documents/project/travel web/f/src/app/layout.js\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/jiumi/Documents/project/travel web/f/src/app/layout.js","default")},2307:()=>{}};