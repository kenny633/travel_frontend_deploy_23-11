(()=>{var e={};e.id=931,e.ids=[931],e.modules={399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},209:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},9348:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},412:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},5315:e=>{"use strict";e.exports=require("path")},7360:e=>{"use strict";e.exports=require("url")},8110:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>l.a,__next_app__:()=>u,pages:()=>d,routeModule:()=>p,tree:()=>c});var r=s(9442),a=s(42),i=s(8190),l=s.n(i),o=s(3289),n={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>o[e]);s.d(t,n);let c=["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,6044)),"/Users/jiumi/Documents/project/travel web/f/src/app/page.js"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,3881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,934)),"/Users/jiumi/Documents/project/travel web/f/src/app/layout.js"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,6042,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,3881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],d=["/Users/jiumi/Documents/project/travel web/f/src/app/page.js"],u={require:s,loadChunk:()=>Promise.resolve()},p=new r.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},3875:(e,t,s)=>{Promise.resolve().then(s.bind(s,6044))},5983:(e,t,s)=>{Promise.resolve().then(s.bind(s,8645))},336:(e,t)=>{"use strict";function s(){return null}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return s}}),("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},226:(e,t,s)=>{"use strict";s.d(t,{Z:()=>l});var r=s(6493),a=s(3606),i=s(7573);let l=({postId:e,initialLikes:t,initialCollections:s,initialIsLiked:l,initialIsCollected:o,initialViews:n})=>{let[c,d]=(0,a.useState)(t),[u,p]=(0,a.useState)(s),[m,x]=(0,a.useState)(l),[g,f]=(0,a.useState)(o),[h,v]=(0,a.useState)(n),[j,y]=(0,a.useState)(!1),[b,w]=(0,a.useState)(null);(0,a.useEffect)(()=>{(async()=>{try{let t=await (0,i.U2)(`/posts/${e}/actions`,{},!0);d(t.likes),p(t.collections),x(t.isLiked),f(t.isCollected),v(t.views)}catch(e){w("Error fetching post actions: "+e.message)}})()},[e]);let _=async()=>{if(!localStorage.getItem("token")){alert("Please login first");return}if(!j){y(!0),w(null),d(m?c-1:c+1),x(!m);try{let t=await (0,i.v_)(`/posts/${e}/like`,{method:"POST"});if(200!==t.status)throw Error("Network response was not ok");let s=await t;d(s.likes),x(s.hasLiked)}catch(e){w("Error liking post: "+e.message),d(m?c+1:c-1),x(e=>!e)}finally{y(!1)}}},k=async()=>{if(!localStorage.getItem("token")){alert("Please login first");return}if(!j){y(!0),w(null),p(g?u-1:u+1),f(e=>!e);try{let t=await (0,i.v_)(`/posts/${e}/collect`,{},!0);if(200!==t.status)throw Error("Network response was not ok");p(t.collections),f(t.isCollected)}catch(e){w("Error collecting post: "+e.message),p(g?u+1:u-1),f(!g)}finally{y(!1)}}};return(0,r.jsxs)("div",{className:"flex space-x-4 mt-2 bg-transparent",children:[b&&(0,r.jsx)("div",{className:"text-red-500",children:b}),(0,r.jsxs)("button",{onClick:_,disabled:j,"aria-label":m?"Unlike post":"Like post",className:`flex items-center space-x-1 px-4 py-2 rounded-lg transition duration-200 ease-in-out ${m?"text-red-500 bg-gray-200 hover:bg-gray-300":"text-gray-500 bg-gray-200 hover:bg-gray-300"}`,children:[(0,r.jsx)("span",{children:m?"❤️":"\uD83E\uDD0D"}),(0,r.jsx)("span",{children:c})]}),(0,r.jsxs)("button",{onClick:k,disabled:j,"aria-label":g?"Uncollect post":"Collect post",className:`flex items-center space-x-1 px-4 py-2 rounded-lg transition duration-200 ease-in-out ${g?"text-yellow-500 bg-gray-200 hover:bg-gray-300":"text-gray-500 bg-gray-200 hover:bg-gray-300"}`,children:[(0,r.jsx)("span",{children:g?"⭐":"☆"}),(0,r.jsx)("span",{children:u})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-1 px-4 py-2 rounded-lg transition duration-200 ease-in-out bg-gray-200 text-gray-800 hover:bg-gray-300",children:[(0,r.jsx)("span",{children:"\uD83D\uDC41️"}),(0,r.jsx)("span",{children:h})]})]})}},8645:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var r=s(6493),a=s(336),i=s.n(a),l=s(5723),o=s(3606);s(7573);var n=s(226);function c(){let[e,t]=(0,o.useState)([]),[s,a]=(0,o.useState)(12),[c,d]=(0,o.useState)(!1);return(0,r.jsxs)("div",{className:"flex flex-col items-center p-5 max-w-[1400px] mx-auto",children:[(0,r.jsxs)(i(),{children:[(0,r.jsx)("title",{children:"旅遊論壇"}),(0,r.jsx)("meta",{name:"description",content:"旅遊論壇主頁"})]}),(0,r.jsxs)("main",{className:"w-full",children:[(0,r.jsx)("h2",{className:"my-5 text-xl font-semibold",children:"最新帖子"}),(0,r.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-5 w-full",children:[...e].sort((e,t)=>new Date(t.Creation_time)-new Date(e.Creation_time)).slice(0,s).map(e=>(0,r.jsxs)("div",{className:"relative group overflow-hidden",children:[(0,r.jsx)(l.default,{href:`/postsample/${e._id}`,className:"block",children:(0,r.jsxs)("div",{className:"relative",children:[e.img_path&&(0,r.jsx)("img",{src:e.img_path,alt:e.title,className:"w-full h-[300px] object-cover transition-transform duration-300 group-hover:scale-105"}),(0,r.jsxs)("div",{className:"absolute inset-0 bg-black bg-opacity-50 opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex flex-col justify-center items-center text-center p-4",children:[(0,r.jsx)("h3",{className:"text-xl font-bold text-white mb-2",children:e.title.length>20?`${e.title.substring(0,20)}...`:e.title}),(0,r.jsx)("p",{className:"text-gray-300 text-sm mb-4",children:new Date(e.Creation_time).toLocaleString(void 0,{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1})})]})]})},e._id),(0,r.jsx)("div",{className:"absolute inset-x-0 bottom-5 flex justify-center transition-opacity duration-300 opacity-0 group-hover:opacity-70",children:(0,r.jsx)(n.Z,{postId:e._id,initialLikes:e.likes,initialCollections:e.collections,initialIsLiked:e.isLiked,initialIsCollected:e.isCollected})})]},e._id))}),c&&(0,r.jsx)("div",{className:"flex justify-center my-5",children:(0,r.jsx)("p",{className:"text-lg text-gray-600",children:"加载中..."})})]})]})}},6044:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(8105).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/jiumi/Documents/project/travel web/f/src/app/page.js\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/jiumi/Documents/project/travel web/f/src/app/page.js","default")},3881:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var r=s(5394);let a=async e=>[{type:"image/x-icon",sizes:"16x16",url:(0,r.fillMetadataSegment)(".",await e.params,"favicon.ico")+""}]}};var t=require("../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[492,870,394,137],()=>s(8110));module.exports=r})();